@model Asp.netCoreDatPhongKS.Models.TaiKhoan
@{
    ViewData["Title"] = "Sửa tài khoản";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="container mt-4">
    <h2>Sửa tài khoản</h2>
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success">@TempData["Success"]</div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger">@TempData["Error"]</div>
    }
    <form asp-action="Edit" asp-controller="QuanLyTaiKhoan" method="post">
        <input type="hidden" asp-for="TaiKhoanId" />
        <input type="hidden" asp-for="VaiTroId" />
        <div class="form-group">
            <label>Vai trò</label>
            <input class="form-control" value="@(Model.VaiTroId == 2 ? "Nhân viên/Lễ tân" : Model.VaiTroId == 3 ? "Khách hàng" : "Không xác định")" disabled />
        </div>
        <div class="form-group">
            <label asp-for="Email">Email</label>
            <input asp-for="Email" class="form-control" required />
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>
        <div class="form-group">
            <label>Mật khẩu mới (để trống nếu không đổi)</label>
            <input name="newMatKhau" type="password" class="form-control" />
        </div>
        <div class="form-group">
            <label asp-for="Hoten">Họ tên</label>
            <input asp-for="Hoten" class="form-control" required />
            <span asp-validation-for="Hoten" class="text-danger"></span>
        </div>
        <div class="form-group">
            <label asp-for="TrangThai">Trạng thái</label>
            <select asp-for="TrangThai" class="form-control" required>
                <option value="true" selected="@(Model.TrangThai == true)">Kích hoạt</option>
                <option value="false" selected="@(Model.TrangThai == false)">Vô hiệu</option>
            </select>
            <span asp-validation-for="TrangThai" class="text-danger"></span>
        </div>
        <div class="form-group">
            <label asp-for="HinhAnh">Hình ảnh</label>
            <input asp-for="HinhAnh" class="form-control" />
            <span asp-validation-for="HinhAnh" class="text-danger"></span>
        </div>
        <button type="submit" class="btn btn-success mt-3">Lưu</button>
        <a href="@Url.Action("Index", "QuanLyTaiKhoan")" class="btn btn-secondary mt-3">Quay lại</a>
    </form>
</div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>
    <script>
        $(document).ready(function () {
            // Bỏ validation phía client cho các trường không bắt buộc
            $('form').validate({
                rules: {
                    Email: { required: true, email: true },
                    Hoten: { required: true },
                    TrangThai: { required: true },
                    HinhAnh: { required: false }
                },
                messages: {
                    Email: { required: "Vui lòng nhập Email.", email: "Email không đúng định dạng." },
                    Hoten: { required: "Vui lòng nhập Họ tên." },
                    TrangThai: { required: "Vui lòng chọn Trạng thái." }
                }
            });

        @if (TempData["Success"] != null)
        {
            @:toastr.success('@TempData["Success"]');
        }
        @if (TempData["Error"] != null)
        {
            @:toastr.error('@TempData["Error"]');
        }
        });
    </script>
